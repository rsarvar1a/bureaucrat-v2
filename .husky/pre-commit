if git diff --cached --name-only | grep -rq '*.sql.ts' bureaucrat/schema/; then

  bun run db:generate || true
  echo ""
  
  if git diff --name-only | grep -q '^migrations/'; then
    echo ""
    echo "New migrations were generated and staged."
    echo "Please rename the migration subfolder in a fixup commit."
    echo ""
  fi

  git add migrations/
else
  echo "No changes to SQL schema files detected. Skipping migration generation."
  echo ""
fi

bun run lint && bun run format
echo ""